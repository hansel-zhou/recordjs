!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Record={})}(this,function(t){"use strict";var l={extend:function(t){var e,n,i,o,r,a=t||{},d=1,s=arguments.length;for(1===s&&(a=this,d=0);d<s;d++)if(e=arguments[d])for(n in e)i=a[n],a!==(o=e[n])&&void 0!==o&&(l.isArray(o)||l.isObject(o)?(l.isArray(o)&&(r=i&&l.isArray(i)?i:[]),l.isObject(o)&&(r=i&&l.isObject(i)?i:{}),a[n]=l.extend(r,o)):a[n]=o);return a},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)}};window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("custom")}catch(t){window.Event=function(t,e,n,i){var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e,n,i),o}}var e={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},h="readystatechange loadstart progress abort error load timeout loadend".split(" "),v="timeout withCredentials".split(" "),m="readyState responseURL status statusText responseType response responseText responseXML".split(" "),n="OK";function f(){this.custom={events:{},requestHeaders:{},responseHeaders:{}}}f.prototype.match=!1,l.extend(f,e),l.extend(f.prototype,e),l.extend(f.prototype,{open:function(t,e,n,i,o){var r=this;function a(t){for(var e,n=0;n<m.length;n++)try{r[m[n]]=s[m[n]]}catch(t){}"readystatechange"===t.type&&4===r.readyState&&(console.log(r),(e=new Event("request")).arguments=r,window.dispatchEvent(e)),r.dispatchEvent(new Event(t.type))}if(l.extend(this.custom,{method:t,url:e,async:"boolean"!=typeof n||n,username:i,password:o,options:{url:e,type:t}}),this.match)return this.readyState=f.OPENED,void this.dispatchEvent(new Event("readystatechange"));var d,s=(d=function(){var t=location.href,e=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/.exec(t.toLowerCase())||[];return/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(e[1])}(),window.ActiveXObject?!d&&c()||function(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}():c());function c(){try{return new window._XMLHttpRequest}catch(t){}}this.custom.xhr=s;for(var p=0;p<h.length;p++)s.addEventListener(h[p],a);i?s.open(t,e,n,i,o):s.open(t,e,n);for(var u=0;u<v.length;u++)try{s[v[u]]=r[v[u]]}catch(t){}},setRequestHeader:function(t,e){var n;this.match?(n=this.custom.requestHeaders)[t]?n[t]+=","+e:n[t]=e:this.custom.xhr.setRequestHeader(t,e)},timeout:0,withCredentials:!1,upload:{},send:function(t){var e=this;if(this.custom.options.body=t,this.match)return this.setRequestHeader("X-Requested-With","MockXMLHttpRequest"),this.dispatchEvent(new Event("loadstart")),console.log(f.HEADERS_RECEIVED),e.readyState=f.HEADERS_RECEIVED,e.dispatchEvent(new Event("readystatechange")),e.readyState=f.LOADING,e.dispatchEvent(new Event("readystatechange")),e.status=200,e.statusText=n,e.response=e.responseText="asdfjiwe",e.readyState=f.DONE,e.dispatchEvent(new Event("readystatechange")),e.dispatchEvent(new Event("load")),void e.dispatchEvent(new Event("loadend"));this.custom.xhr.send(t)},abort:function(){this.custom.xhr.abort()}}),l.extend(f.prototype,{responseURL:"",status:f.UNSENT,statusText:"",getResponseHeader:function(t){return this.custom.xhr.getResponseHeader(t)},getAllResponseHeaders:function(){return this.custom.xhr.getAllResponseHeaders()},overrideMimeType:function(){},responseType:"",response:null,responseText:"",responseXML:null}),l.extend(f.prototype,{addEventListener:function(t,e){var n=this.custom.events;n[t]||(n[t]=[]),n[t].push(e)},removeEventListener:function(t,e){for(var n=this.custom.events[t]||[],i=0;i<n.length;i++)n[i]===e&&n.splice(i--,1)},dispatchEvent:function(t){for(var e=this.custom.events[t.type]||[],n=0;n<e.length;n++)e[n].call(this,t);var i="on"+t.type;this[i]&&this[i](t)}}),window.XMLHttpRequest=f;var i={recordArr:[],requestArr:[],starttime:0,endtime:0,duration:0,width:0,height:0,events:[{id:1,event:"click",target:document.documentElement},{id:2,event:"scroll",target:window},{id:3,event:"touchstart",target:document.documentElement},{id:4,event:"touchmove",target:document.documentElement},{id:5,event:"touchend",target:document.documentElement},{id:6,event:"change",target:document.documentElement},{id:7,event:"input",target:document.documentElement},{id:8,event:"onpopstate",target:window},,{id:9,event:"pushState",target:window},{id:10,event:"replaceState",target:window},{id:11,event:"request",target:window}],start:function(){this.starttime=(new Date).getTime(),this.width=window.innerWidth,this.height=window.innerHeight,this.startEventListener()},stop:function(){var e=this;this.endtime=(new Date).getTime(),this.duration=this.endtime-this.starttime,this.events.forEach(function(t){t.target.removeEventListener(t.event,e.handler[t.event])})},startEventListener:function(){var e=this;this.events.forEach(function(t){t.target.addEventListener(t.event,e.handler[t.event].bind(e))}),window.addEventListener("xhrRequest",this.addRequest)},generateRecord:function(t){var e=(new Date).getTime();return{id:t,time:e,duration:e-this.starttime}},handler:{click:function(t){var e=i.generateRecord(1);e.pointer={left:t.clientX,top:t.clientY},e.domPath=i.getDompath(t.target),e.type="click",c.push(e)},scroll:o(function(t){i.generateRecord(2)}),touchstart:o(function(t){var e=i.generateRecord(3);e.type="scroll",e.pointer={left:t.touches[0].screenX,top:t.touches[0].screenY},c.push(e)}),touchmove:o(function(t){var e=i.generateRecord(4);e.type="touchmove",console.log(t.touches),e.pointer={left:t.touches[0].screenX,top:t.touches[0].screenY},c.push(e)}),touchend:o(function(t){var e=i.generateRecord(5);e.type="touchend",e.pointer={left:t.changedTouches[0].screenX,top:t.changedTouches[0].screenY},c.push(e)}),change:function(){var t=i.generateRecord(6);t.type="change",c.push(t)},input:function(){var t=i.generateRecord(7);t.type="input",c.push(t)},onpopstate:function(){var t=i.generateRecord(8);t.type="onpopstate",c.push(t)},pushState:function(){var t=i.generateRecord(9);t.type="pushState",c.push(t)},replaceState:function(){var t=i.generateRecord(10);t.type="replaceState",c.push(t)},request:function(t){var e=t.arguments,n=e.custom,i=e.responseText,o=e.status;this.requestArr.push({options:n.options,responseText:i,status:o})}},getDompath:function(t){for(var e=t,n=[];null!=e.parentElement;){for(var i=0,o=0,r=0;r<e.parentElement.childNodes.length;r+=1){e.parentElement.childNodes[r]===e&&(o=i),i+=1}var a="> "+e.nodeName.toLowerCase();e.hasAttribute("id")&&""!==e.id?n.unshift(a+"#"+e.id):1<i?n.unshift(a+":nth-child("+(o+1)+")"):n.unshift(a),e=e.parentElement}return n.slice(1).join(" ").substring(2)}};function o(n,t){var i=1<arguments.length&&void 0!==t?t:1e3,o=0;return function(){var t=arguments,e=(new Date).valueOf();i<=e-o&&(n.apply(this,t),o=e)}}i.start();var r=i.start,a=i.stop,d=i.startEventListener,s=i.generateRecord,c=i.recordArr,p=i.requestArr,u=i.handler,y=i.events,g={replatClick:function(t){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});document.querySelector(t.domPath).dispatchEvent(e)},replatScroll:function(){},replatTouch:function(){},replayChange:function(){},playInit:function(){},playTimer:6e5,playdata:[],NFS:60,playPosition:0,playDataIndex:0,player:null,play:function(){if(g.player)return g.player;g.player=setInterval(function(){if(w[g.playDataIndex].duration-g.playPosition<=1e3/g.NFS){if(g.playDataIndex>=w.length-1)return clearInterval(g.player),void(g.player=null);console.log(w[g.playDataIndex].type,g.playDataIndex),g.playDataIndex=g.playDataIndex+1}else console.log("hhhh");g.playPosition=g.playPosition+1e3/g.NFS},1e3/g.NFS)},timeout:function(){return console.log("暂停"),clearInterval(g.player),!(g.player=null)},suspend:function(){return console.log("停止"),clearInterval(g.player),g.player=null,g.playPosition=0,!(g.playDataIndex=0)},forward:function(){},backoff:function(){}},w=[{id:3,time:1595829579674,duration:5415,type:"scroll",pointer:{left:272,top:788.7999877929688}},{id:5,time:1595829579892,duration:5633,type:"touchend",pointer:{left:272,top:788.7999877929688}},{id:1,time:1595829579897,duration:5638,pointer:{left:200,top:793},domPath:"div#app > div:nth-child(2) > div#cmp-footer > div > div:nth-child(2) > div:nth-child(2) > span",type:"click"},{id:3,time:1595829581001,duration:6742,type:"scroll",pointer:{left:372,top:776.7999877929688}},{id:5,time:1595829581220,duration:6961,type:"touchend",pointer:{left:372,top:776.7999877929688}},{id:1,time:1595829581224,duration:6965,pointer:{left:321,top:779},domPath:"div#app > div:nth-child(2) > div#cmp-footer > div > div:nth-child(3) > div:nth-child(1) > img:nth-child(1)",type:"click"},{id:3,time:1595829582560,duration:8301,type:"scroll",pointer:{left:262.3999938964844,top:782.4000244140625}},{id:5,time:1595829582779,duration:8520,type:"touchend",pointer:{left:262.3999938964844,top:782.4000244140625}},{id:1,time:1595829582786,duration:8527,pointer:{left:188,top:786},domPath:"div#app > div:nth-child(2) > div#cmp-footer > div > div:nth-child(2) > div:nth-child(1) > img:nth-child(1)",type:"click"},{id:3,time:1595829583749,duration:9490,type:"scroll",pointer:{left:152.8000030517578,top:783.2000122070312}},{id:5,time:1595829583967,duration:9708,type:"touchend",pointer:{left:152.8000030517578,top:783.2000122070312}},{id:1,time:1595829583974,duration:9715,pointer:{left:54,top:787},domPath:"div#app > div:nth-child(2) > div#cmp-footer > div > div:nth-child(1) > div:nth-child(1) > img:nth-child(1)",type:"click"},{id:3,time:1595829585391,duration:11132,type:"scroll",pointer:{left:352.8000183105469,top:393.6000061035156}},{id:5,time:1595829585595,duration:11336,type:"touchend",pointer:{left:352.8000183105469,top:393.6000061035156}},{id:1,time:1595829585600,duration:11341,pointer:{left:308,top:314},domPath:"div#app > div:nth-child(2) > div#app-mall > div:nth-child(4) > div:nth-child(1) > a:nth-child(2) > span",type:"click"},{id:3,time:1595829587886,duration:13627,type:"scroll",pointer:{left:280.8000183105469,top:552}},{id:4,time:1595829588105,duration:13846,type:"touchmove",pointer:{left:285.6000061035156,top:532}},{id:5,time:1595829588634,duration:14375,type:"touchend",pointer:{left:351.20001220703125,top:257.6000061035156}},{id:3,time:1595829594195,duration:19936,type:"scroll",pointer:{left:292,top:356}},{id:5,time:1595829594404,duration:20145,type:"touchend",pointer:{left:292,top:356}},{id:1,time:1595829594408,duration:20149,pointer:{left:224,top:266},domPath:"div#app > div:nth-child(2) > div#app-list > div:nth-child(2) > div:nth-child(2) > div#cmp-card > div:nth-child(1) > img",type:"click"},{id:3,time:1595829597447,duration:23188,type:"scroll",pointer:{left:267.20001220703125,top:314.3999938964844}},{id:5,time:1595829597659,duration:23400,type:"touchend",pointer:{left:267.20001220703125,top:314.3999938964844}},{id:1,time:1595829597665,duration:23406,pointer:{left:194,top:215},domPath:"div#app > div:nth-child(2) > div:nth-child(1) > div > div#cmp-group > div#cmp-input > div > div:nth-child(2) > div > input",type:"click"},{id:7,time:1595829599066,duration:24807,type:"input"},{id:7,time:1595829599386,duration:25127,type:"input"},{id:7,time:1595829599646,duration:25387,type:"input"},{id:7,time:1595829599888,duration:25629,type:"input"},{id:7,time:1595829600036,duration:25777,type:"input"},{id:6,time:1595829602558,duration:28299,type:"change"}],E=g.play,R=g.timeout,x=g.suspend,b=g.forward,D=g.backoff;t.start=r,t.stop=a,t.startEventListener=d,t.generateRecord=s,t.recordArr=c,t.requestArr=p,t.handler=u,t.events=y,t.play=E,t.timeout=R,t.suspend=x,t.forward=b,t.backoff=D,Object.defineProperty(t,"__esModule",{value:!0})});
